<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°©.í•™_ì„ ìƒë‹˜ì±„íŒ…</title>

    <!-- WS & ê¸°ë³¸ CSS -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.5.1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="shortcut icon" href="/favicon/favicon.ico" type="image/x-icon">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-gothic.css" rel="stylesheet">

    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Nanum Gothic', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #eef4ff 0, #f6f8ff 35%, #f9fafb 100%);
            color: #111827;
        }

        /* ---------- ê³µí†µ ë ˆì´ì•„ì›ƒ ---------- */

        main.chat-page {
            min-height: calc(100vh - 180px);  /* í—¤ë”/í‘¸í„° ì œì™¸í•œ ì˜ì—­ */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 32px 16px 40px;
        }

        .chat-shell {
            width: 100%;
            max-width: 1180px;
            background: #ffffff;
            border-radius: 28px;
            box-shadow:
                    0 24px 60px rgba(15, 23, 42, 0.13),
                    0 0 0 1px rgba(148, 163, 184, 0.18);
            padding: 24px 28px 28px;
        }

        .chat-shell-header {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }

        .chat-shell-title-row {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .chat-title {
            font-size: 1.4rem;
            font-weight: 700;
            letter-spacing: -0.03em;
        }

        .chat-badge {
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            color: #1d4ed8;
            background: linear-gradient(135deg, #e0f2ff, #e0f2fe);
            border: 1px solid rgba(37, 99, 235, 0.2);
        }

        .chat-description {
            font-size: 0.86rem;
            line-height: 1.5;
            color: #6b7280;
        }

        /* ---------- ìƒÂ·í•˜ë‹¨ 2ì»¬ëŸ¼ ë ˆì´ì•„ì›ƒ ---------- */

        .chat-layout {
            display: grid;
            grid-template-columns: 320px minmax(0, 1fr);
            gap: 20px;
        }

        /* ---------- ì™¼ìª½ : í•™ìƒ ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ ---------- */

        .chat-sidebar-card {
            background: #f9fafb;
            border-radius: 24px;
            padding: 18px 18px 20px;
            box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.25);
            display: flex;
            flex-direction: column;
            height: 520px;
        }

        .sidebar-title {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #111827;
        }

        .sidebar-subtitle {
            font-size: 0.78rem;
            color: #9ca3af;
            margin-bottom: 10px;
        }

        .student-list-wrapper {
            margin-top: 6px;
            flex: 1;
            overflow-y: auto;
        }

        .member-list {
            /* ê¸°ì¡´ JSì—ì„œ member-list í´ë˜ìŠ¤ë¥¼ ì“°ë¯€ë¡œ ê·¸ëŒ€ë¡œ ì‚¬ìš© */
        }

        #studentList {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        #studentList li {
            padding: 10px 12px;
            border-radius: 14px;
            background: #ffffff;
            font-size: 0.86rem;
            font-weight: 500;
            color: #111827;
            border: 1px solid rgba(148, 163, 184, 0.4);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.15s ease;
        }

        #studentList li span {
            pointer-events: none;
        }

        #studentList li:hover {
            border-color: #2563eb;
            background: #eff4ff;
        }

        #studentList li.active {
            border-color: #2563eb;
            background: #e0ebff;
            box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.25);
        }

        #studentList li .student-id {
            font-size: 0.72rem;
            color: #9ca3af;
        }

        /* ---------- ì˜¤ë¥¸ìª½ : ì±„íŒ… ì˜ì—­ ---------- */

        .chat-main {
            background: #f9fafb;
            border-radius: 24px;
            padding: 16px 18px 18px;
            box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.25);
            display: flex;
            flex-direction: column;
            height: 520px;
        }

        .chat-main-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 4px 10px;
            border-bottom: 1px solid rgba(226, 232, 240, 0.9);
            margin-bottom: 10px;
        }

        .chat-main-header-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .chat-main-header-label {
            font-size: 0.8rem;
            color: #9ca3af;
        }

        .chat-main-header-name {
            font-size: 0.98rem;
            font-weight: 600;
            color: #111827;
        }

        .status-pill {
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.72rem;
            font-weight: 600;
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #15803d;
            background: rgba(22, 163, 74, 0.09);
        }

        .chat-window {
            flex: 1;
            margin-top: 6px;
            background: #f3f4f6;
            border-radius: 18px;
            padding: 14px 14px 10px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        #chatMessages {
            list-style: none;
            margin: 0;
            padding: 0 4px 4px;
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .chat-empty {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.86rem;
            color: #9ca3af;
            pointer-events: none;
        }

        /* ë©”ì‹œì§€ê°€ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ ì•ˆë‚´ë¬¸ ìˆ¨ê¸°ê¸° */
        #chatMessages:not(:empty) + .chat-empty {
            display: none;
        }

        .message {
            max-width: 70%;
            padding: 8px 11px;
            border-radius: 18px;
            font-size: 0.84rem;
            line-height: 1.5;
            word-wrap: break-word;
            box-shadow: 0 1px 2px rgba(15, 23, 42, 0.08);
        }

        .message.self {
            align-self: flex-end;
            background: #1d4ed8;
            color: #ffffff;
            border-bottom-right-radius: 4px;
        }

        .message.other {
            align-self: flex-start;
            background: #e5e7eb;
            color: #111827;
            border-bottom-left-radius: 4px;
        }

        .chat-input-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            background: #ffffff;
            border-radius: 999px;
            padding: 8px 10px 8px 16px;
            box-shadow:
                    0 12px 25px rgba(15, 23, 42, 0.12),
                    0 0 0 1px rgba(148, 163, 184, 0.4);
        }

        #messageInput {
            border: none;
            outline: none;
            flex: 1;
            font-size: 0.9rem;
            background: transparent;
        }

        #messageInput::placeholder {
            color: #cbd5f5;
        }

        .send-btn {
            width: 38px;
            height: 38px;
            border-radius: 999px;
            border: none;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 12px 25px rgba(37, 99, 235, 0.45);
            transition: transform 0.12s ease, box-shadow 0.12s ease, filter 0.12s ease;
        }

        .send-btn:hover {
            filter: brightness(1.03);
            transform: translateY(-1px);
            box-shadow: 0 16px 30px rgba(37, 99, 235, 0.55);
        }

        .send-btn i {
            font-size: 16px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 960px) {
            .chat-layout {
                grid-template-columns: 1fr;
                height: auto;
            }

            .chat-sidebar-card,
            .chat-main {
                height: auto;
            }
        }

        @media (max-width: 640px) {
            .chat-shell {
                padding: 20px 16px 22px;
            }
        }
    </style>
</head>
<body>

<header>
    <nav>
        <div th:if="${session.teacherLoginId eq null}">
            <ul>
                <li><a href="/resume/rwrite">ì…ì‚¬ì§€ì›</a></li>
                <li><a href="/bWriteFormT">ë¬¸ì˜</a></li>
            </ul>
        </div>
        <div th:if="${session.teacherLoginId ne null}">
            <ul>
                <li><a th:href="@{/tMySchedule/{tId}(tId=${session.teacherLoginId})}">ìŠ¤ì¼€ì¤„</a></li>
                <li><a th:href="@{/tStudents/{tId}(tId=${session.teacherLoginId})}">í•™ìƒê´€ë¦¬</a></li>
                <li><a th:href="@{/tMyInfo/{tId}(tId=${session.teacherLoginId})}">ë§ˆì´ í˜ì´ì§€</a></li>
                <li><a href="/bWriteFormT">ë¬¸ì˜</a></li>
            </ul>
        </div>
    </nav>

    <div class="logo">
        <a href="/teacher/Tmain"><img src="/File/logo_white.png" alt="ë¡œê³ "></a>
    </div>

    <div th:if="${session.teacherLoginId eq null}">
        <a id="login">ë¡œê·¸ì¸</a>
    </div>

    <div th:if="${session.teacherLoginId ne null}">
        <input type="hidden" id="loginId" name="loginId" th:value="${session.teacherLoginId}"/>
        <a href="/tLogout" id="logout">ë¡œê·¸ì•„ì›ƒ</a>
    </div>
</header>

<main class="chat-page">
    <div class="chat-shell">
        <!-- ìƒë‹¨ íƒ€ì´í‹€ -->
        <div class="chat-shell-header">
            <div class="chat-shell-title-row">
                <span class="chat-title">í•™ìƒ Â· ì„ ìƒë‹˜ 1:1 ì±„íŒ…</span>
                <span class="chat-badge">ì‹¤ì‹œê°„ ìƒë‹´</span>
            </div>
            <div class="chat-description">
                ë‹´ë‹¹í•˜ê³  ìˆëŠ” í•™ìƒê³¼ ìˆ˜ì—… ì¤‘ ê¶ê¸ˆí•œ ì ì„ ë°”ë¡œ ê³µìœ í•´ ë³´ì„¸ìš”.<br>
                ì™¼ìª½ì—ì„œ í•™ìƒì„ ì„ íƒí•˜ë©´ í•´ë‹¹ í•™ìƒê³¼ì˜ ëŒ€í™” ë‚´ì—­ì´ ì˜¤ë¥¸ìª½ì— í‘œì‹œë©ë‹ˆë‹¤.
            </div>
        </div>

        <!-- ë³¸ë¬¸ ë ˆì´ì•„ì›ƒ -->
        <div class="chat-layout">

            <!-- ì™¼ìª½ : í•™ìƒ ëª©ë¡ -->
            <aside class="chat-sidebar-card member-list">
                <div class="sidebar-title">ë‹´ë‹¹ í•™ìƒ ì„ íƒ</div>
                <div class="sidebar-subtitle">ëª©ë¡ì—ì„œ í•™ìƒì„ ì„ íƒí•˜ë©´ ì±„íŒ…ì´ ì‹œì‘ë©ë‹ˆë‹¤.</div>

                <div class="student-list-wrapper">
                    <ul id="studentList">
                        <li th:each="student : ${studentList}"
                            th:id="${student.sId}"
                            th:data-name="${student.sName}"
                            onclick="openChatRoom(this)">
                            <span th:text="${student.sName}">í•™ìƒ ì´ë¦„</span>
                            <span class="student-id" th:text="'ID: ' + ${student.sId}"></span>
                        </li>
                    </ul>
                </div>
            </aside>

            <!-- ì˜¤ë¥¸ìª½ : ì±„íŒ… ì˜ì—­ -->
            <section class="chat-main">
                <div class="chat-main-header">
                    <div class="chat-main-header-text">
                        <span class="chat-main-header-label">ì±„íŒ… ìƒëŒ€</span>
                        <span class="chat-main-header-name" id="chatWith">ì—†ìŒ</span>
                    </div>
                    <span class="status-pill">ëŒ€ê¸° ì¤‘</span>
                </div>

                <div class="chat-window">
                    <ul id="chatMessages"></ul>
                    <div class="chat-empty">
                        í•™ìƒì„ ì„ íƒí•˜ë©´ ì´ê³³ì—ì„œ ì±„íŒ…ì´ ì‹œì‘ë©ë‹ˆë‹¤.
                    </div>
                </div>

                <div class="chat-input-bar">
                    <input type="text" id="messageInput"
                           placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
                           onkeypress="handleKeyPress(event)">
                    <button class="send-btn" onclick="sendPrivateMessage()">
                        <i class="fa-solid fa-paper-plane"></i>
                    </button>
                </div>
            </section>

        </div>
    </div>
</main>

<footer class="common-footer">
    <div class="inner-footer">
        <div class="footer-wrap">
            <div class="info-cont">
                <p class="info-txt">ê³ ê°ì„¼í„° <strong>1588-9956</strong> í‰ì¼ 09:00~18:00(ê³µíœ´ì¼ ì œì™¸)</p>
                <p class="address">â€»ê³ ê°ì„¼í„°(ì½œì„¼í„°) ì´ìš© ì‹œ í†µì‹ ìš”ê¸ˆì´ ë¶€ê³¼ ë©ë‹ˆë‹¤.</p>
                <ul class="footer-menu">
                    <li style="color:deepskyblue; font-weight:bold;"><a href="/Etc/Privacy">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</a></li>
                    <li><a href="/Etc/Clause">ì„œë¹„ìŠ¤ì•½ê´€</a></li>
                    <li><a href="/Inquiry/OnlineInquiry">ê³ ê°ì„¼í„°</a></li>
                    <li><a href="/Customer/BusinessWrite">ì œíœ´ë¬¸ì˜</a></li>
                    <li><a href="/Etc/SiteMap">ì‚¬ì´íŠ¸ë§µ</a></li>
                </ul>
                <address class="address">
                    ì¸ì²œ ë¯¸ì¶”í™€êµ¬ ë§¤ì†Œí™€ë¡œ488ë²ˆê¸¸ 6-32 íƒœìŠ¹ë¹Œë”© 5ì¸µ (ì£¼)ë°©í•™
                    <span>í†µì‹ íŒë§¤ì—… ì‹ ê³  : ì œ 2025-ì¸ì²œë¯¸ì¶”í™€êµ¬-1567í˜¸</span>
                </address>
            </div>
            <div class="etc-cont">
                <div class="btn-group sns">
                    <p class="sns-title">SNS</p>
                    <a href="https://www.instagram.com" title="ìƒˆì°½ì—´ê¸°" target="_blank" class="sns-btn instar">
                        <i class="fa-brands fa-instagram"></i><span class="hide"> ì¸ìŠ¤íƒ€ê·¸ë¨</span></a>
                    <a href="https://www.youtube.com" title="ìƒˆì°½ì—´ê¸°" target="_blank" class="sns-btn instar">
                        <i class="fa-brands fa-youtube"></i><span class="hide"> ìœ íŠœë¸Œ</span></a>
                    <a href="https://section.blog.naver.com" title="ìƒˆì°½ì—´ê¸°" target="_blank" class="sns-btn instar">
                        <i class="fa-brands fa-facebook-f"></i><span class="hide"> í˜ì´ìŠ¤ë¶</span></a>
                </div>
            </div>
        </div>
        <div class="copy-cont">
            Copyright Â© Bang.Hak All Right Reserved
        </div>
    </div>
</footer>

<script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
        crossorigin="anonymous"></script>

<!-- ê¸°ì¡´ ë„¤ë¹„ / ë¡œê·¸ì¸ ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ (í•„ìš”ì‹œ ìˆ˜ì •) -->
<script>
    let loginId = $("#loginId").val();

    $('#logout').click(() => {
        location.href = '/tLogout';
    });

    $('#login').click(() => {
        location.href = '/loginFormT';
    });
</script>

<!-- WebSocket / ì±„íŒ… ë¡œì§ (ê¸°ì¡´ ì½”ë“œ ê·¸ëŒ€ë¡œ) -->
<script>
    let stompClient = null;
    let userData = {
        username: document.getElementById('loginId').value,
        connected: false
    };
    let currentPrivateChat = '';

    window.onload = function () {
        if (userData.username) {
            connect();
        } else {
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            location.href = '/tLoginForm';
        }
    };

    function connect() {
        if (stompClient !== null && stompClient.connected) {
            console.log("[WebSocket] ì´ë¯¸ ì—°ê²°ë˜ì–´ ìˆìŒ.");
            return;
        }

        const socket = new SockJS('/ws');
        stompClient = Stomp.over(socket);

        stompClient.connect({}, function () {
            console.log("[WebSocket] ì—°ê²° ì„±ê³µ");

            if (!stompClient.alreadySubscribed && userData.username) {
                // ğŸ”¹ ì‹¤ì‹œê°„ ì±„íŒ… ë©”ì‹œì§€ êµ¬ë…
                stompClient.subscribe(
                    `/user/${userData.username}/private-message`,
                    onPrivateMessage
                );

                // ğŸ”¹ íƒ€ì´í•‘ ìƒíƒœ êµ¬ë…
                stompClient.subscribe(
                    `/user/${userData.username}/typing`,
                    onTypingEvent
                );

                stompClient.alreadySubscribed = true;
                console.log("[WebSocket] êµ¬ë… ì™„ë£Œ");
            }
        }, function (error) {
            console.error("[WebSocket ì˜¤ë¥˜] ì—°ê²° ì‹¤íŒ¨:", error);
            setTimeout(connect, 3000);
        });
    }


    function showMessage(message, containerId, messageClass) {
        const chatMessages = document.getElementById(containerId);
        const lastMessage = chatMessages.lastChild;
        if (lastMessage && lastMessage.textContent.includes(message.message)) {
            console.warn("[ê²½ê³ ] ë™ì¼í•œ ë©”ì‹œì§€ ê°ì§€, ì¶”ê°€ ì•ˆí•¨:", message);
            return;
        }

        const messageElement = document.createElement('div');
        messageElement.className = `message ${messageClass}`;
        messageElement.textContent = `[${message.senderName}] ${message.message}`;

        chatMessages.appendChild(messageElement);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function onPrivateMessage(payload) {
        const message = JSON.parse(payload.body);
        const tId = document.getElementById('loginId').value;

        console.log("[WebSocket] ìˆ˜ì‹ ëœ ë©”ì‹œì§€:", message);

        if (message.senderName === currentPrivateChat || message.receiverName === currentPrivateChat) {
            const chatMessages = document.getElementById('chatMessages');
            const lastMessage = chatMessages.lastChild;

            if (lastMessage && lastMessage.textContent.includes(message.message)) {
                console.warn("[ê²½ê³ ] ì¤‘ë³µ ë©”ì‹œì§€ ê°ì§€, í‘œì‹œ ì•ˆí•¨:", message);
                return;
            }

            const messageClass = message.senderName === tId ? 'self' : 'other';
            showMessage(message, 'chatMessages', messageClass);
        }
    }

    function handleKeyPress(event) {
        if (event.key === 'Enter') {
            sendPrivateMessage();
            event.preventDefault();
        }
    }

    function sendPrivateMessage() {
        const messageInput = document.getElementById('messageInput');
        const messageContent = messageInput.value.trim();
        const tId = document.getElementById('loginId').value;
        const sId = currentPrivateChat;

        if (messageContent && sId) {
            const chatMessage = {
                senderName: tId,
                receiverName: sId,
                message: messageContent,
                date: new Date().toISOString(),
                status: "MESSAGE"
            };
            console.log("[ë””ë²„ê¹…] ë³´ë‚´ëŠ” ë©”ì‹œì§€:", chatMessage);

            stompClient.send('/app/private-message', {}, JSON.stringify(chatMessage));
            showMessage(chatMessage, 'chatMessages', 'self');
            messageInput.value = '';
        } else {
            alert("í•™ìƒì„ ì„ íƒí•˜ê³  ë©”ì‹œì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        }
    }

    function openChatRoom(element) {
        const sId = element.id;
        const sName = element.getAttribute("data-name") || element.textContent;
        const tId = document.getElementById('loginId').value;

        document.getElementById('chatWith').textContent = sName;
        currentPrivateChat = sId;

        document.querySelectorAll(".member-list li").forEach(li => li.classList.remove("active"));
        element.classList.add("active");

        fetch(`/chat/api/history?sId=${sId}&tId=${tId}`)
            .then(response => response.json())
            .then(messages => {
                console.log("[ë””ë²„ê¹…] ì„œë²„ ì‘ë‹µ ë°ì´í„°:", messages);
                const chatMessages = document.getElementById('chatMessages');
                chatMessages.innerHTML = '';

                if (Array.isArray(messages)) {
                    messages.forEach(message => {
                        let messageClass;
                        if (String(message.senderName).trim() === String(tId).trim()) {
                            messageClass = 'self';
                        } else if (String(message.receiverName).trim() === String(tId).trim()) {
                            messageClass = 'other';
                        } else {
                            console.warn("[ê²½ê³ ] í•„í„°ë§ë˜ì§€ ì•Šì€ ë©”ì‹œì§€:", message);
                            return;
                        }

                        showMessage(message, 'chatMessages', messageClass);
                    });
                }
            })
            .catch(error => console.error("ë©”ì‹œì§€ ë¡œë“œ ì˜¤ë¥˜:", error));
    }


    // íƒ€ì´í•‘ ì‹œë„ì¤‘
    let typingTimeout;

    document.getElementById("messageInput").addEventListener("input", () => {
        sendTypingSignal();

        clearTimeout(typingTimeout);
        typingTimeout = setTimeout(() => {
            sendStopTyping();
        }, 2500); // 2.5ì´ˆ ë™ì•ˆ ì¶”ê°€ ì…ë ¥ ì—†ìœ¼ë©´ STOP
    });

    function sendTypingSignal() {
        if (!currentPrivateChat) return;

        const typingMsg = {
            senderName: userData.username,
            receiverName: currentPrivateChat,
            status: "TYPING"
        };
        stompClient.send("/app/typing", {}, JSON.stringify(typingMsg));
    }

    function sendStopTyping() {
        if (!currentPrivateChat) return;

        const typingMsg = {
            senderName: userData.username,
            receiverName: currentPrivateChat,
            status: "STOP_TYPING"
        };
        stompClient.send("/app/typing", {}, JSON.stringify(typingMsg));
    }

    let typingTimer;

    function onTypingEvent(payload) {
        const msg = JSON.parse(payload.body);
        const statusLabel = document.querySelector(".status-pill");
        if (!statusLabel) return;

        if (msg.status === "TYPING") {
            statusLabel.textContent = "ì…ë ¥ ì¤‘...";
            clearTimeout(typingTimer);
            typingTimer = setTimeout(() => {
                statusLabel.textContent = "ëŒ€ê¸° ì¤‘";
            }, 2000);
        } else if (msg.status === "STOP_TYPING") {
            statusLabel.textContent = "ëŒ€ê¸° ì¤‘";
        }
    }




</script>
</body>
</html>
